{% extends 'base.html' %}
{% block content %}
<div class="page-header">
    <h2>เบิกสินค้า</h2>
</div>

<div class="card form-card">
    <form method="POST">
        <select name="product_id" required>
            <option value="" disabled selected>-- เลือกสินค้า --</option>
            {% for p in products %}
            <option value="{{ p.id }}">{{ p.name }} (คงเหลือ: {{ p.stock_qty }})</option>
            {% endfor %}
        </select>
        <input type="number" name="quantity" placeholder="จำนวนที่เบิก" required>
        <input type="text" name="note" placeholder="หมายเหตุ (ถ้ามี)">
        <button type="submit" class="btn-primary">
             <i class="fa-solid fa-check"></i> ยืนยันการเบิก
        </button>
    </form>
</div>

<div class="list-container">
    <h3>รายการเบิกล่าสุด</h3>
    {% for item in issue_items|reverse %}
    <div class="card item-card history-card">
        <div class="item-info">
            <div class="item-title">{{ item.product.name }}</div>
            <div class="item-subtitle">Doc: {{ item.issue.doc_number }} | วันที่: {{ item.issue.date.strftime('%d-%m-%Y') }}</div>
        </div>
        <div class="item-qty issue">
            <span>-{{ item.quantity }}</span>
        </div>
    </div>
    {% else %}
    <div class="card empty-card">
        <p>ยังไม่มีรายการเบิก</p>
    </div>
    {% endfor %}
</div>
{% endblock %}
